<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disponibilidad de Apartamentos - Vista de Edificio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .modal-transition {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .modal-hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }

        .modal-visible {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-8 text-center">
            <h1 id="project-name" class="text-3xl sm:text-4xl font-bold text-gray-900">Proyecto RIVER PARK</h1>
            <p class="text-lg text-gray-600 mt-1">Disponibilidad por Piso</p>

            <div class="flex flex-wrap gap-4 mt-6 justify-center">
                <div class="flex items-center"><span
                        class="w-5 h-5 rounded-full bg-green-500 mr-2 border border-green-600 shadow-sm"></span><span>Disponible</span>
                </div>
                <div class="flex items-center"><span
                        class="w-5 h-5 rounded-full bg-yellow-400 mr-2 border border-yellow-500 shadow-sm"></span><span>Reservado</span>
                </div>
                <div class="flex items-center"><span
                        class="w-5 h-5 rounded-full bg-red-500 mr-2 border border-red-600 shadow-sm"></span><span>Vendido</span>
                </div>
                <div class="flex items-center"><span
                        class="w-5 h-5 rounded-full bg-gray-200 mr-2 border border-gray-400 shadow-sm"></span><span>Zonas Comunes</span>
                </div>
            </div>
        </header>

        <main id="building-layout" class="bg-white p-4 sm:p-6 rounded-2xl shadow-lg space-y-4">
            <div id="loading-state" class="col-span-full flex flex-col items-center justify-center py-16">
                <p id="loading-message" class="mt-4 text-gray-600 font-semibold">Cargando y construyendo la vista del
                    edificio...</p>
            </div>
            </main>
    </div>

    <div id="details-modal"
        class="modal-transition modal-hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto transform">
            <div id="modal-content" class="p-6"></div>
            <div class="bg-gray-50 px-6 py-4 rounded-b-2xl text-right">
                <button onclick="closeModal()"
                    class="px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors">Cerrar</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATOS DE EJEMPLO ---
        // JSON generado a partir de la última imagen proporcionada.
        const apartmentData = [
    {
        "id_interno": "4574143000261107599",
        "titulo_item": "APT-2902",
        "precio": 701595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261107585",
        "titulo_item": "APT-1808",
        "precio": 460070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261106521",
        "titulo_item": "APT-2607",
        "precio": 698595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261105455",
        "titulo_item": "APT-3007",
        "precio": 702595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261103562",
        "titulo_item": "APT-2407",
        "precio": 696595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261103555",
        "titulo_item": "APT-2204",
        "precio": 578690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261102458",
        "titulo_item": "APT-2004",
        "precio": 576690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261100528",
        "titulo_item": "APT-2703",
        "precio": 674625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261099463",
        "titulo_item": "APT-2304",
        "precio": 579690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261098440",
        "titulo_item": "APT-2306",
        "precio": 670625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261098433",
        "titulo_item": "APT-2207",
        "precio": 694595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261098426",
        "titulo_item": "APT-2008",
        "precio": 462070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261097496",
        "titulo_item": "APT-2808",
        "precio": 451970000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261097489",
        "titulo_item": "APT-1805",
        "precio": 581800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261096543",
        "titulo_item": "APT-1906",
        "precio": 666625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261095520",
        "titulo_item": "APT-1806",
        "precio": 665625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261093533",
        "titulo_item": "APT-2906",
        "precio": 676625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261093526",
        "titulo_item": "APT-2406",
        "precio": 671625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261092615",
        "titulo_item": "APT-3005",
        "precio": 581800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261092608",
        "titulo_item": "APT-2405",
        "precio": 587800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261092601",
        "titulo_item": "APT-2403",
        "precio": 671625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261092594",
        "titulo_item": "APT-2202",
        "precio": 694595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261091497",
        "titulo_item": "APT-3008",
        "precio": 472070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261091490",
        "titulo_item": "APT-2005",
        "precio": 583800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261090469",
        "titulo_item": "APT-2602",
        "precio": 698595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261090462",
        "titulo_item": "APT-2105",
        "precio": 584800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261089458",
        "titulo_item": "APT-1902",
        "precio": 691595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261088500",
        "titulo_item": "APT-2805",
        "precio": 579800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261088493",
        "titulo_item": "APT-2505",
        "precio": 588800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261088486",
        "titulo_item": "APT-2305",
        "precio": 586800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261087537",
        "titulo_item": "APT-2708",
        "precio": 469070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261087530",
        "titulo_item": "APT-2208",
        "precio": 464070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261086618",
        "titulo_item": "APT-2802",
        "precio": 700595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261086611",
        "titulo_item": "APT-2404",
        "precio": 580690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085500",
        "titulo_item": "APT-2903",
        "precio": 676625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085493",
        "titulo_item": "APT-2806",
        "precio": 675625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085486",
        "titulo_item": "APT-2801",
        "precio": 470070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085479",
        "titulo_item": "APT-2604",
        "precio": 582690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085472",
        "titulo_item": "APT-2508",
        "precio": 467070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085458",
        "titulo_item": "APT-1802",
        "precio": 690595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261085451",
        "titulo_item": "APT-1704",
        "precio": 573690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261084467",
        "titulo_item": "APT-2606",
        "precio": 673625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261083562",
        "titulo_item": "APT-1804",
        "precio": 562840000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261082548",
        "titulo_item": "APT-2905",
        "precio": 580800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261082541",
        "titulo_item": "APT-2506",
        "precio": 672625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261082534",
        "titulo_item": "APT-2107",
        "precio": 693595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261081534",
        "titulo_item": "APT-3004",
        "precio": 574840000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261081527",
        "titulo_item": "APT-2503",
        "precio": 672625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261080523",
        "titulo_item": "APT-2803",
        "precio": 675625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261080516",
        "titulo_item": "APT-2205",
        "precio": 585800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261080509",
        "titulo_item": "APT-2103",
        "precio": 668625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261064480",
        "titulo_item": "APT-2904",
        "precio": 585690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261064473",
        "titulo_item": "APT-2203",
        "precio": 655250000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261064466",
        "titulo_item": "APT-1904",
        "precio": 563840000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261063501",
        "titulo_item": "APT-2705",
        "precio": 578800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261063487",
        "titulo_item": "APT-2307",
        "precio": 695595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261062539",
        "titulo_item": "APT-2303",
        "precio": 670625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261027488",
        "titulo_item": "APT-2007",
        "precio": 692595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018491",
        "titulo_item": "APT-2502",
        "precio": 697595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018484",
        "titulo_item": "APT-2501",
        "precio": 476120000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018470",
        "titulo_item": "APT-2206",
        "precio": 669625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018463",
        "titulo_item": "APT-2102",
        "precio": 663745000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018456",
        "titulo_item": "APT-2006",
        "precio": 667625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261018449",
        "titulo_item": "APT-1803",
        "precio": 665625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261009577",
        "titulo_item": "APT-3003",
        "precio": 677625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261009570",
        "titulo_item": "APT-2704",
        "precio": 571840000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261006558",
        "titulo_item": "APT-2605",
        "precio": 589800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000261006551",
        "titulo_item": "APT-1905",
        "precio": 582800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260984452",
        "titulo_item": "APT-2908",
        "precio": 471070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260984445",
        "titulo_item": "APT-2408",
        "precio": 466070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260976512",
        "titulo_item": "APT-2804",
        "precio": 572840000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260976505",
        "titulo_item": "APT-1705",
        "precio": 580800000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260974523",
        "titulo_item": "APT-2507",
        "precio": 697595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260974516",
        "titulo_item": "APT-2504",
        "precio": 581690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260974509",
        "titulo_item": "APT-2402",
        "precio": 696595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260974502",
        "titulo_item": "APT-1903",
        "precio": 652250000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260969535",
        "titulo_item": "APT-2901",
        "precio": 471070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260969528",
        "titulo_item": "APT-2308",
        "precio": 465070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260951523",
        "titulo_item": "APT-2706",
        "precio": 674625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260946498",
        "titulo_item": "APT-2608",
        "precio": 449970000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260946491",
        "titulo_item": "APT-1908",
        "precio": 461070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260931538",
        "titulo_item": "APT-2603",
        "precio": 673625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260931531",
        "titulo_item": "APT-1807",
        "precio": 690595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260931524",
        "titulo_item": "APT-1707",
        "precio": 689595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260929583",
        "titulo_item": "APT-2907",
        "precio": 701595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260929576",
        "titulo_item": "APT-1706",
        "precio": 664625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260928485",
        "titulo_item": "APT-2701",
        "precio": 469070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260928478",
        "titulo_item": "APT-2302",
        "precio": 695595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260928471",
        "titulo_item": "APT-2002",
        "precio": 692595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260924494",
        "titulo_item": "APT-2707",
        "precio": 699595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260923469",
        "titulo_item": "APT-2003",
        "precio": 667625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260923462",
        "titulo_item": "APT-1907",
        "precio": 691595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260907511",
        "titulo_item": "APT-2108",
        "precio": 463070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260907504",
        "titulo_item": "APT-2001",
        "precio": 462070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260903460",
        "titulo_item": "APT-3002",
        "precio": 702595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260903453",
        "titulo_item": "APT-2104",
        "precio": 577690000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260903446",
        "titulo_item": "APT-1708",
        "precio": 459070000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260896498",
        "titulo_item": "APT-3006",
        "precio": 677625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260896491",
        "titulo_item": "APT-2807",
        "precio": 700595000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    },
    {
        "id_interno": "4574143000260896484",
        "titulo_item": "APT-2106",
        "precio": 668625000,
        "moneda": "COP",
        "estado": "disponible",
        "tipo_inmueble": "APARTAMENTO"
    }
];

        // --- FUNCIONES DE LA INTERFAZ ---
        function getColorForStatus(status) {
            // Normaliza el estado a minúsculas para la comparación
            const normalizedStatus = status ? status.toLowerCase() : '';
            switch (normalizedStatus) {
                case 'disponible': return 'bg-green-500 hover:bg-green-600 border-green-600';
                case 'opcionado': return 'bg-yellow-400 hover:bg-yellow-500 border-yellow-500';
                case 'vendido': return 'bg-red-500 hover:bg-red-600 border-red-600';
                default: return 'bg-gray-400 hover:bg-gray-500 border-gray-500';
            }
        }

        const currencyFormatter = new Intl.NumberFormat('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 });

        function showModal(apartment) {
            const modal = document.getElementById('details-modal');
            const modalContent = document.getElementById('modal-content');
            // Capitaliza el estado para mostrarlo
            let capitalizedStatus = apartment.estado.charAt(0).toUpperCase() + apartment.estado.slice(1);
            if (capitalizedStatus.toLowerCase() === 'opcionado') {
                capitalizedStatus = 'Reservado';
            }


            modalContent.innerHTML = `
                <div class="flex justify-between items-start">
                    <h2 class="text-2xl font-bold text-gray-900">${apartment.titulo_item}</h2>
                    <span class="px-3 py-1 text-sm font-medium rounded-full ${getColorForStatus(apartment.estado).replace(/hover:bg-\w+-\d{3}\s?/g, '')} text-white">${capitalizedStatus}</span>
                </div>
                <div class="mt-4 space-y-3 text-gray-600">
                    <p><strong class="font-semibold text-gray-800">Precio:</strong> ${currencyFormatter.format(apartment.precio)}</p>
                    <p><strong class="font-semibold text-gray-800">Piso:</strong> ${apartment.floor || 'No especificado'}</p>
                    <p><strong class="font-semibold text-gray-800">Tipo:</strong> ${apartment.tipo_inmueble}</p>
                    <p><strong class="font-semibold text-gray-800">Proyecto:</strong> RIVER PARK</p>
                    <p><strong class="font-semibold text-gray-800">ID Interno:</strong> ${apartment.id_interno}</p>
                </div>
            `;
            modal.classList.remove('modal-hidden');
            modal.classList.add('modal-visible');
        }

        function closeModal() {
            const modal = document.getElementById('details-modal');
            modal.classList.add('modal-hidden');
            modal.classList.remove('modal-visible');
        }

        // --- EJECUCIÓN PRINCIPAL ---
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('building-layout');
            const loadingStateEl = document.getElementById('loading-state');

            // 1. Filtrar solo los apartamentos del objeto de datos
            const apartments = apartmentData.filter(inmueble => inmueble.tipo_inmueble === 'APARTAMENTO');

            if (apartments.length === 0) {
                loadingStateEl.innerHTML = `<p class="text-center text-gray-500">No se encontraron apartamentos en los datos proporcionados.</p>`;
                return;
            }

            // 2. Extraer el número de piso y agrupar los apartamentos
            const floors = {};
            apartments.forEach(apt => {
                const match = apt.titulo_item.match(/APT-(\d+)/);
                let floorNumber = 0;
                if (match && match[1]) {
                    const num = match[1];
                    // Asume que los dos últimos dígitos son el número de puerta, el resto es el piso.
                    if (num.length > 2) {
                        floorNumber = parseInt(num.substring(0, num.length - 2), 10);
                    } else {
                         floorNumber = parseInt(num, 10); // Para nombres como APT-5, APT-6 etc
                    }
                }
                apt.floor = floorNumber;

                if (!floors[floorNumber]) {
                    floors[floorNumber] = [];
                }
                floors[floorNumber].push(apt);
            });

            // 3. Renderizar la interfaz del edificio
            loadingStateEl.remove();
            container.innerHTML = '';

            // Ordenar los pisos de mayor a menor para mostrar el más alto arriba
            const sortedFloorNumbers = Object.keys(floors).sort((a, b) => b - a);

            sortedFloorNumbers.forEach(floorNumber => {
                const floorRow = document.createElement('div');
                // Ajuste de estilo: gap-2 sm:gap-4 para juntar el label y la grilla
                floorRow.className = "flex items-center gap-2 sm:gap-4 border-b border-gray-200 py-3";

                // Etiqueta del piso
                const floorLabel = document.createElement('div');
                floorLabel.className = "w-16 text-center font-bold text-md text-gray-700 shrink-0";
                floorLabel.innerHTML = `Piso <span class="block text-xl">${floorNumber}</span>`;
                floorRow.appendChild(floorLabel);

                // Contenedor de los apartamentos para ese piso
                const gridDiv = document.createElement('div');
                // Ajuste de estilo: Aumentado el número de columnas para que quepan más
                gridDiv.className = "flex-1 grid grid-cols-8 gap-1.5";
                
                // Definir el orden correcto de las columnas para el sort
                const columnOrder = ['01', '02', '03', '04', '05', '06', '07', '08'];
                
                // Mapa para encontrar apartamentos por su número de puerta
                const aptMap = new Map();
                floors[floorNumber].forEach(apt => {
                    const doorNumber = apt.titulo_item.slice(-2);
                    aptMap.set(doorNumber, apt);
                });

                // Crear y añadir las tarjetas de los apartamentos en el orden correcto
                columnOrder.forEach(door => {
                    const apt = aptMap.get(door);
                    const card = document.createElement('div');
                    
                    if (apt) {
                        card.className = `py-2 px-1 rounded text-white font-semibold shadow-sm cursor-pointer transform hover:-translate-y-0.5 transition-all duration-200 border-b-2 text-center ${getColorForStatus(apt.estado)}`;
                        // Mostrar el número del apartamento (ej: 2901)
                        card.innerHTML = `<div class="text-xs font-medium">${apt.titulo_item.split('-')[1]}</div>`;
                        card.addEventListener('click', () => showModal(apt));
                    } else {
                        // Espacio vacío si no hay apartamento de ese tipo en ese piso
                         card.className = `py-2 px-1 rounded bg-gray-200`;
                    }
                    gridDiv.appendChild(card);
                });


                floorRow.appendChild(gridDiv);
                container.appendChild(floorRow);
            });
        });

        document.getElementById('details-modal').addEventListener('click', function (event) {
            if (event.target === this) closeModal();
        });
    </script>
</body>

</html>
